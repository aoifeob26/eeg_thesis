---
title: "Functional Data Analysis of EEG Data: Comparing Alcoholics and Controls"
author: "Aoife O'Brien and Alannah Blacoe"
date: "2025-06-21"
output:
  rticles::arxiv_article:
    number_sections: true
    toc: true
    toc_depth: 3
    keep_tex: true
bibliography: references.bib
csl: apa.csl
link-citations: yes
nocite: |
  @*
header-includes:
  - \usepackage{sectsty}
  - \sectionfont{\Large}
  - \subsectionfont{\large}
  - \usepackage{float}
  - \usepackage{booktabs}
  - \usepackage{caption}
  - \usepackage{longtable}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage[table]{xcolor}
  - \usepackage{etoolbox}
  - \pretocmd{\bibliography}{\clearpage\vspace*{-5em}\renewcommand{\section}[2]{}\renewcommand{\subsection}[2]{}}{}{}
---


**Aoife O'Brien** (Student ID: 21349803)  
**Alannah Blacoe** (Student ID: 20344276)


*Background:*

Alcoholism can be associated as a catalyst for cognitive decline and altered brain function, however detecting consistent neural markers is considered challenging. Electroencephalography (EEG), with high temporal relotuion, provides a non-invasive method to measure brain activity using precise time measurements whilst offering a method to help explore the presented differences. Traditional EEG studies tend to focus on average responses/peak amplitudes which discards imperative information about how the brain’s response changes over time.  

*Objectives:*

This study investigates whether EEG signal shape can distinguish alcoholic from control participants. It explores differences in brain response to varying visual stimuli, the potential for unsupervised clustering, and the predictive power of EEG shape-based features.

*Methods:*

EEG data were collected from 16 participants (8 alcoholic, 8 control) across three visual stimulus conditions. Signals from the FP1 and FP2 electrodes were smoothed using Fourier and B-Spline basis functions and analysed via Functional Principal Component Analysis (FPCA). FPCA scores were used for clustering and classification using LASSO and Random Forest models. Permutation tests assessed group-level differences.

*Findings and Interpretation:*

Statistically significant differences in EEG curve shape were observed between groups, particularly during cognitively demanding S2 No-Match trials (p = 0.021). These patterns likely reflect altered cognitive processing in alcoholics compared to controls. FPCA components, when used with machine learning classifiers such as random forests, provided moderate to strong predictive performance when distinguishing from matching conditions based on EEG signal shape.


Classification models reached up to 75% accuracy, suggesting that the FPCA features captured useful differences between groups. Clusters were closer aligned to the type of stimulus shown rather than whether the person was alcoholic or not. This suggests the brain’s response was more strongly shaped by how surprising or expected the stimuli was, opposed to the alcohol status. Overall, the shape of the EEG signals helped highlight differences in how people process information, particularly during tasks that required more attention.
 
---

\tableofcontents
\newpage

---

# Introduction

## Context:

Alcohol use disorder (AUD) has been linked to impairments in cognitive control, attention, and stimulus processing. [@Polich1994; @Porjesz2003] Individuals with AUD often show deficits in tasks requiring cognitive control and flexibility, these effects from changes are believed to have measurable neural correlates. [@Begleiter1981] EEG provides a non-invasive method of capturing brain activity with millisecond-level precision and is thus well-suited for studying cognitive processing in real-time. [@Klem1999; @Lotte2018]

## Why EEG?

EEG offers several advantages for studying brain function: it is cost-effective, non-invasive, and highly sensitive to the rapid changes  in cognitive processing and brain activity. This makes it an ideal tool for comparing brain responses between groups with subtle neurological differences, such as alcoholics and controls.
EEG’s high time resolution allows us to gain meaningful insight into how brain activity changes from moment to moment, which is essential when studying fast processes like attention and decision-making, associated with the frontal regions we focused on (fp1 & fp2). [@Handy2005; @Delorme2004]


## Stimuli and Sensor Selection

In this study, participants were exposed to three types of visual stimuli: [@Snodgrass1980]

* S1 (Object): A single image,

* S2 Match: Two identical images,

* S2 No-Match: Two different images.

These conditions were designed to test how the brain responds to repeated versus unexpected visual inputs.  

EEG signals were recorded using 64 electrodes across the scalp, but our analysis focused on two frontal sites: FP1 and FP2. These electrodes were chosen because frontal regions are closely associated with cognitive function, attention, and decision making, all of which are areas known to be affected by alcohol use. Focusing on FP1 and FP2 also helped reduce data complexity while still capturing meaningful differences in brain response. [@Klem1999]

## What Has Been Done Before: EEG Studies in Alcoholism Research  

There is a substantial amount of EEG research that have investigated cognitive dysfunction associated with alcohol use disorder. Many of these studies focus on event-related potentials (ERPs), which are averaged EEG responses that are time-locked to stimulus presentation. One commonly studied ERP is the P300 component, [@Polich2007] which typically appears 300 milliseconds after a rare/unexpected stimulus and reflects attention and stimulus evaluation processes. [@Chiou2016; @Zhang2020]


## Other studies [@Kamarajan2006]

From previous studies there is a consistent patterns of participants with AUD showing a lower P300 amplitude, [@Polich1994] this would indicate weaker cognitive processing. A study example Polish et al (1994) reported that the P300 responses for alcoholics were reported to be smaller during oddball tasks which would allude to reduced attention. Similarly Porjesz and Begleiter (2003) reviewed ERP and suggested that a lower P300 may even reflect a genetic risk factor for alcoholism. [@Porjesz2003]


Previous studies, have used the basic features of EEG signals by utilising findings such as average voltage, peak amplitudes and/or response time to compare alcoholics and non-alcoholics. These studies tend to focus on particular parts of the EEG signal, making the data easier to work with but in return losing a lot of time-related details. [@Rangaswamy2007]

## Limitations of Prior Work

Traditional EEG analysis techniques reduce complex, time-varying signals to single summary statistics. This approach risks oversimplifying the data—for instance, two signals might have the same peak amplitude but very different trajectories before and after the peak. Moreover, these methods often rely on assumptions like normality that may not hold. [@Handy2005]

Very few studies have retained the full shape of EEG signals in their analyses, and even fewer have applied this approach in the context of alcohol-related research. [@Nichols2001; @Maris2007]


This is where Functional Data Analysis (FDA) becomes especially useful it treats the EEG as a smooth curve and therefore preserves the full shape of the brain's electrical response over time. This allows subtle differences in rise/fall patterns or oscillatory behaviour to be captured and then compared between groups. [@Ramsay2005; @Ramsay2009]

## Gap in the Literature:

As previously stated, the aforementioned studies relied heavily on single-point summaries, indicating the EEGs overall shape, how it rises and falls and fluctuates over time is being ignored. Basing it off factors such as peak amplitude or means can be seen as a major limitation. For example two participants may have the same peak value but show completely different signal patterns leading up and following this peak value. Traditional methods miss these key differences which left a gap for a study that utilises these time-based differences. [@Chiou2016; @Zhang2020]


## Our Approach and Motivation:  

In this study, we aim to move beyond summary statistics and keep the entire time-based structure on the EEG signals we focused on. We utilised Functional Data Analysis, to ensure each EEG trial was treated as a continuous curve rather than isolated points. FPCA allowed us to breakdown the EEG data into a set of shape-based components that kept the key patterns and differences. These components were later used to explore clustering too group similar patterns together and classification to predict a subject identifier (control or alcoholic).  [@Breiman2001; @Tibshirani1996]


## Research Aims and Questions:

This project was guided by the following research questions:

1. Do EEG patterns differ between alcoholics and controls?

2. How do different visual stimuli (S1 – Object, S2 – Match, and S2 – No-Match) affect EEG signals?

3. Can EEG curve shapes be used to group participants using clustering methods?

4. Can we predict group membership (alcoholic or control) from EEG data using classification models?


---

# Methods

## Data Description

The dataset used throughout our studies was obtained from UCI Machine Learning Repository which was hosted on Kaggle: https://www.kaggle.com/datasets/nnair25/Alcoholics.  

This dataset contains 16 participants divided into two groups 8 alcoholics and 8 control subjects. Each participant undertook numerous trials in which they were exposed to various visual stimuli while their brain activity was recorded by 64 electrodes. The electrodes were positioned on the scalp following the International 10 – 20 System. [@Klem1999].

 

EEG signals were sampled at 256 Hz, which provides a datapoint at approximately every 3.9 milliseconds. The trials lasted one second and contained 265 time points per trial. The given data included multiple trials per multiple participant, however, for our study we focussed on the first trial from each participant for each stimuli to ensure consistency.

**Visual Stimuli Conditions:**
Each participant was shown images from Snodgrass & Vanderwart standardised picture set (1980) under three different conditions. [@Snodgrass1980]

* S1 Object: A single image presented from the picture set

* S2 Match: Two identical images presented sequentially from the picture set

* S2 No-Match: Two different images presented sequentially from the picture set

The aim for these conditions was to test how the brain responds to visual repetition versus unexpected change. The S2 No-Match condition introduces an unexpected mismatch requiring increased processing which is expected to evoke a stronger cognitive response. [@Polich2007]

**Electrode Selection:**

Although data was recorded from all 64 electrode sensors, our analysis focused on two frontal electrodes in particular FP1 & FP2 (https://commons.wikimedia.org/wiki/File:EEG_10-10_system_with_additional_information.svg)  

\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/brain_diagram.png}
\caption{EEG Electrode Layout and Associated Brain Regions.}
\end{figure}

These electrodes were selected for our study as frontal brain regions are known to play a key role in attention, inhibition and cognitive function, all of which are often impaired with over consumption of alcohol or AUD. [@Handy2005] Focussing on these two frontal sensors allowed us to capture meaningful insight into the differences in brain function based off these domains, while reducing computational complexity. These electrodes are often focussed on in previous EEG & ERP studies investigating alcohol-related processing, making them theoretically and practically justified as focal points for our analysis.  

## Data Classification

Two main classification problems were investigated in this study: [@Lotte2018]

1. **Subject Identifier:** A binary classification task, distinguishing whether the EEG signal belonged to an *alcoholic* or *control* participant. This outcome was derived from subject metadata and labelled as a factor with two levels: `a` (alcoholic) and `c` (control).

2. **Matching Condition:** A multinomial classification task, predicting which stimulus condition the trial belonged to. The three conditions were as mentioned above:
   - `S1`: Single object image (baseline condition)
   - `S2 Match`: Two identical images
   - `S2 No-Match`: Two different images

The input features for these classification tasks were the functional principal component (FPC) scores extracted from FPCA applied to the smoothed EEG curves from the FP1 and FP2 sensors. [@Ramsay2009; @RamsaySilverman2002] These scores capture variation in curve shape and were used as predictors in subsequent machine learning models.

Classification models were trained independently for each task to evaluate how well EEG shape alone could distinguish between subject groups and task conditions.

---

## Pre-processing

Before Analysis, the raw EEG signals underwent pre-processing to reduce noise and prepare for curve-based modelling. Originally, each trial recorded 256 discrete time points, subsequently, these points were smoothed into a continuous function using B-spline basis functions. [@deBoor2001] This approach allowed us to treat these EEG signals as curves and extract meaningful patterns across a given time period. This smoothing process was a crucial step to prepare the data for later Functional Principle Component Analysis (FPCA), [@RamsaySilverman2002] which relies on capturing overall shape and investigating key components.

Figure 2 illustrates a typical raw EEG trial for each of the three stimulus types prior to smoothing. The unsmoothed signals appear highly variable, with substantial trial-to-trial and timepoint noise. This visual underscores why smoothing is an important first step to highlight the underlying temporal pattern in the signal.

\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/rawdata.png}
\caption{Raw EEG Curves}
\end{figure}

By smoothing these raw EEG signals into functional curves, we can reduce noise while preserving important temporal structure, a crucial first step for the functional analyses that follow.

---

## Statistical Analysis Overview

To provide a clear summary of how each research objective was addressed, Table 1 outlines the primary statistical methods used throughout the study.

```{r thesis-methods-table-kableextra, echo=FALSE, results='asis', message=FALSE, warning=FALSE}
library(knitr)
library(kableExtra)

df <- data.frame(
  Objective = c(
    "1. EEG Signal Decomposition",
    "2. Clustering EEG Patterns",
    "3. Group Prediction",
    "4. Interpretive Visualisation"
  ),
  `Primary Analysis` = c(
    "Functional Principal Component Analysis (FPCA) using Fourier basis (7 functions); includes mean function, scree plot, and eigenfunctions.",
    "K-means clustering on FPCA scores (components 1–6); evaluated for alignment with alcohol status and matching condition.",
    "LASSO, Multinomial, and Random Forest models using FPCA scores from FP1 and FP2 to predict alcohol status.",
    "Wiggly EEG plots, cluster-coloured curves, score-based summaries, and group/condition difference plots."
  )
)

kable(df, format = "latex", booktabs = TRUE, longtable = FALSE, caption = "Overview of Statistical Methods by Thesis Objective") %>%
  kable_styling(latex_options = c("hold_position", "striped"), full_width = FALSE) %>%
  column_spec(1, width = "5cm") %>%
  column_spec(2, width = "10cm")

```

---

## Permutation Testing
A central aim throughout this study was to determine whether statistically significant differences exist between the control and alcoholic participant’s EEG signals. Due to EEG data typically being high dimensional, non-normally distributed and noisy, traditional parametric statistical tests such as ANOVA & t-test are not appropriate in this context. [@Maris2007] To address this, we applied a permutation test. A permutation test is a non-parametric method that makes no assumptions about the underlying distribution of the data, which is far more reliable for this context. [@Nichols2001]

***Rationale for Permutation Test:***

Throughout this study we utilised this test type to assess whether the observed differences between the subject identifier’s (alcoholic’s vs. control’s) average EEG curves were greater than what would be expected to occur by chance. This step is crucial for evaluating our first research question (Research Question 1) which asked whether EEG patterns differ between subject identifier groups.  

**How it works:**  

We initially focused on the FP1 electrode and ran the test separately for each of the three stimulus conditions (S1 obj, S2 Match and S2 No-Match). For these condition group the steps are as follows:

* Compute the Observed Test Statistic: Calculate the pointwise differences in mean EEG curves between the two subject identifiers (alcoholic and controls). [@Nichols2001] This gives a curve representing the observed group difference over time.

* Generate a null distribution: Randomly shuffle the group labels (alcoholic/control) 1000 times, and with each shuffle recalculate the group difference to create a distribution of test statistics under the null hypothesis (in this case no group effect).

* Calculate a p-value: We compared the observed test statistic to the null distribution. The p-value was defined as the proportion of permuted test statistics that were greater than or equal to the observed value. A low p-value (p < 0.05) indicates that the observed group difference is unlikely to have occurred by chance.

**Why This Approach is Appropriate:**

Permutation testing aligns well with the nature of EEG data. It not only avoids assumptions of normality but also respects the time-dependent structure of EEG curves, by retaining the full functional form of the EEG curves. It provides a distribution-free method for inference, increasing confidence in results derived from a smaller sample size, such as ours (n = 16). [@Groppe2011]

Given these significant differences in raw signals, we next applied Functional Data Analysis (FDA) to better preserve the temporal structure and capture these effects more holistically.

---

## Functional Data Analysis (FDA)

Following the permutation tests, which revealed meaningful group-level differences in EEG signal shape, Functional Data Analysis (FDA) offered a principled approach to preserve the temporal structure of the signals and move beyond traditional summary-based methods (Ramsay et al., 2009; Ramsay & Silverman, 2002). Conventional EEG analyses often reduce signals to peak amplitudes or mean values, discarding time-varying information that may differentiate groups (Chiou & Müller, 2016; Zhang et al., 2020). In contrast, FDA models each trial as a smooth curve, capturing the full trajectory of the signal over time. This enables the detection of subtle patterns in variability while reducing noise through curve smoothing. The resulting functional representation provides a foundation for subsequent analyses, including Functional Principal Component Analysis (FPCA), which extracts dominant modes of shape-based variation (Ramsay et al., 2009; Ramsay & Silverman, 2002).

**Smoothing and Basis Functions:**

Each raw EEG signal was recorded at 256 discrete time points over a one-second trial. To facilitate functional data techniques, we expressed these discrete time series as smooth curves using basis expansions [@deBoor2001].


**B-Spline Basis Functions:**

Localised polynomial basis functions that are flexible and perform well when signals vary rapidly in certain time windows [@deBoor2001; @RamsaySilverman2002]. They were initially considered with cubic splines and tuned via cross-validation to capture short-lived features without introducing excessive noise.


**Fourier Basis Functions:**

Built from sine and cosine waves, these are ideal for modelling periodic, rhythmic data and capturing global features efficiently [@Ramsay2009]. Fourier basis functions provide a concise representation, especially when the signal exhibits smooth, oscillatory patterns, ideal for EEG signals as this is known to be a common feature. [@RamsaySilverman2002; @Chiou2016].


\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/smooth_mean_eeg.png}
\caption{EEG Curve Smoothing.}
\end{figure}
 
Figure 3 shows the mean EEG curves after applying the smoothing process. The smooth representation highlights the key temporal features while removing irregular, trial-specific noise.

**Comparison and Final Choice:**

Initially, we focused on cubic B-Splines for our analysis using cross-validation to avoid overfitting. However, upon further research we discovered Fourier basis functions. We found they offered a more interpretable and concise representation of the underlying EEG patterns, with fewer basis functions needed to capture the same signal complexity. [@Ramsay2009; @Zhang2020]

After comparing both approaches, our final smoothing decision was to use Fourier basis functions with 7 basis elements in our FPCA. We found that this balanced model simplicity and curve integrity. Visual inspection of smoothed curves showed that Fourier-based representations offered more consistent reconstructions across participants and stimulus conditions. These comparisons supported the use of Fourier basis functions in the next stage of analysis.

**Preparing for Functional Principal Component Analysis**

With each EEG signal expressed as a smooth functional component, we then applied Functional Component Analysis (FPCA). This next stage extracted the dominant shape-based components of variation across subjects, allowing us to explore patterns that characterise different groups and conditions. [@Ramsay2009; @Chiou2016; @Zhang2020]


---

## Functional Principal Component Analysis (FPCA)

Functional Principal Component Analysis (FPCA) is a foundational tool in FDA. Its approach is to break each subject’s EEG curve down into a mean function alongside a weighted sum of FPCA components (otherwise known as eigenfunctions or modes of variation). [@RamsaySilverman2002; @Ramsay2009] Each principal component helps capture a distinct shape feature in the data, such as changes in amplitude, timing, and/or curvature. The scores assigned to each component for a given subject suggest how strongly that subject’s signal expresses that particular feature.

**How FPCA was used:**
FPCA was applied separately to the FP1 and FP2 electrodes, for each trial’s smoothed EEG signal. We initially extracted 10 components per electrode, but retained the first six for further analysis, as these collectively explained the vast majority of variance. Specifically, the first three components typically covered over 90% of the total variance:

* PC1 typically captured overall amplitude differences.

* PC2 represented latency shifts (timing of peaks).

* PC3 captured more subtle, localised shape variations.

Each EEG signal was represented by a vector of FPCA scores (e.g.  PC1 – PC6). This summarised their EEG signal shape in a low-dimensional but meaningful and informative way. These scores were subsequently used as input features for clustering and classification models.

These FPCA scores formed the core feature set for subsequent clustering and classification modelling, allowing us to analyse EEG shape across participants without discarding critical temporal structure.

Mathematically, each EEG curve can be expressed as a sum of shape-based components:

$$
X_i(t) = \mu(t) + \sum_{k=1}^{K} \xi_{ik} \phi_k(t)
$$

where $\mu(t)$ is the mean curve, $\phi_k(t)$ are the FPCA components (eigenfunctions), and $\xi_{ik}$ are the scores for subject i on component k. [@RamsaySilverman2002; @Ramsay2009]

By transforming each raw EEG signal into a small set of meaningful FPCA scores, we greatly reduced the data’s complexity while preserving the most important features of the temporal signal.

---

## Clustering

Following the extraction of key shape-based features from FPCA, we employed unsupervised clustering to explore whether EEG signal shapes alone could reveal meaningful groupings among participant trials, particularly with respect to alcoholism status and stimulus type. [@Hastie2009; @Lotte2018; @Zhang2020]

**Clustering Algorithm: K-Means**

We selected K-means clustering as our primary algorithm due to its simplicity, interpretability, and effectiveness in identifying compact, spherical clusters in multidimensional space. [@Hastie2009; @Breiman2001] K-means divides data into k groups by minimising the within-cluster sum of squares, assigning each observation to the nearest cluster centroid.

While more complex algorithms could also be applied such as hierarchical clustering, we found K-means provided a conceptually clear and computationally efficient approach to explore the latent structure in the FPCA score space.  

**Input Features**

The clustering was performed on the combined FPCA score matrix, which included the first six FPCA components from both FP1 and FP2 electrodes. These components represented the most important modes of variation in EEG signal shape and provided a low-dimensional summary of each participant's response. [@RamsaySilverman2002; @Ramsay2009]

* Each row in the input matrix corresponded to a participant-trial.

* Each column represented a principal component score, capturing variation in signal shape (e.g. amplitude, latency, waveform pattern).

We retained only those components explaining substantial variance, ensuring the clustering was driven by meaningful differences.

Combining FP1 and FP2 information allowed us to represent frontal brain activity comprehensively while preserving electrode-specific contributions.

**Determining the Number of Clusters**

To select the optimal number of clusters (k), we explored:

* Elbow plots: plotting total within-cluster variance across a range of k values to identify diminishing returns.

* Silhouette analysis: measuring how similar each observation is to its own cluster versus others. [@Rousseeuw1987]

These diagnostics, along with theoretical considerations of task/stimulus types and expected heterogeneity, led us to focus on k = 3 as a meaningful partition of the data.

**Visualisation and Interpretation**

Once each trial was assigned to a cluster, we performed the following analyses to interpret the clustering structure:

* Visualise clusters in principal component space.  

* Overlay clusters on raw EEG curves, coloured by membership, to examine whether clusters represented distinct waveform shapes.

* Compare cluster compositions with known group labels (alcoholic vs control) and stimuli, to evaluate whether natural groupings aligned with meaningful clinical or experimental categories.

These visualisations allowed us to assess whether clusters reflected meaningful differences in EEG shape and whether they aligned with group status or stimulus condition, highlighting the potential of EEG curve features to reveal underlying structure without supervision. [@Lotte2018]

The resulting cluster labels were then examined in subsequent analyses (Results) to evaluate their correspondence with group status and stimulus condition.

---

## Classification Modelling
Having established that EEG signal shape differs between alcoholics and controls through permutation testing, and that unsupervised clustering reveals latent structure in the data, we next explored whether these differences could be used to predict group membership. Specifically, we tested whether a participant’s alcoholism status could be predicted based on FPCA-derived features. [@Ramsay2009; @Chiou2016; @Zhang2020]

To achieve this, we trained and compared multiple supervised classification models using the principal component scores as input features. [@Hastie2009; @Breiman2001]

**Feature Set: FPCA Scores**

The input for all models was a feature matrix consisting of the first six principal component scores extracted via FPCA from FP1 and FP2 electrodes. These scores compactly represent the shape of each EEG curve, summarising its most important temporal features.

Each row represented one trial, and the outcome variable was binary:

* 1 = Alcoholic

* 0 = Control

To prevent overfitting and allow generalisation, we used a train-test split (70/30), and evaluated model performance on the unseen test set.

**LASSO Logistic Regression**

Rationale:
 LASSO (Least Absolute Shrinkage and Selection Operator) is a penalised regression method that performs variable selection and regularisation. It is particularly well-suited to high-dimensional data like FPCA scores, where only a subset of features may be relevant.

Implementation:
 We applied LASSO logistic regression using 10-fold cross-validation to select the regularisation parameter  that minimised classification error.

Advantages:

* Automatically reduces less relevant FPCA components.

* Produces interpretable models by shrinking coefficients to zero.

**Random Forest**

Rationale:
 Random Forest is a tree-based ensemble method that aggregates predictions from multiple decision trees, reducing variance and improving accuracy. It is non-parametric and can capture nonlinear interactions between predictors.

Implementation:
 We trained a Random Forest classifier using default parameters, tuning the number of trees and variables per split (mtry) based on out-of-bag error.

Advantages:

* Robust to outliers and overfitting.

* Captures complex interactions between components.

* Provides variable importance metrics, indicating which PCs contributed most to prediction.

**Multinomial Logistic Regression**

Rationale:
 Although our primary classification task is binary (alcoholic vs. control), we also considered stimulus condition (S1, S2 Match, S2 No-Match) as an outcome, allowing the use of multinomial logistic regression for exploratory purposes.

Implementation:
 We fitted a multinomial logit model using FPCA scores as predictors, and evaluated its performance on correctly classifying trials by stimulus condition.

Advantages:

* Allows extension to multiclass problems.

* Provides a baseline comparison to more complex methods.

 

**Model Evaluation**

To investigate the performance of our classification models, we assessed the following standard evaluation metrics:

* Accuracy: The proportion of correctly predicted labels out of the number of predictions made. Used to give an overall sense of model performance.

* Sensitivity (True Positive Rate): The proportion of alcoholic participants correctly identified as alcoholics. This can be important for scenarios where filing to detect alcoholism is more detrimental than a false alarm.

* Specificity (True Negative Rate): The proportion of controls who were correctly classified as non-alcoholics. High specificity indicates the model is not producing false positives by identifying healthy individuals as alcoholic. We ensured to utilise confusion matrices to visualise the breakdown if true/false positives and negatives for each of the models.

This allowed us to interpret model performance in a more detailed way opposed to a single accuracy score. These metrics were calculated for each of the classifiers e.g. Random Forest, LASSO and Multinomial Logistic Regression, as well as each basis function (Fourier & B-Spline). This gave us the opportunity to efficiently compare their effectiveness in predicting group status from FPCA scores.


These analyses provided a comprehensive evaluation of the predictive power of EEG shape features. All methods were implemented using R, leveraging a range of specialised packages for functional data analysis, visualisation, and predictive modelling.

## Software and Implementation

Analyses were conducted in R using various R packages.
Analyses heavily relied on the following core R packages:

*tidyverse: for data wrangling and tidy data management
*fda, fda.usc: for functional data representation and FPCA
*nnet: for multinomial logistic regression
*randomForest: for ensemble-based predictive modelling
*cluster: for k-means clustering and cluster diagnostics
*glmnet: for penalised regression (LASSO)
*ggplot2: for producing plots and visualisation
*caret: for model training and validation
*dplyr: for data manipulation
*knitr, rmarkdown: for reporting and document generation

This environment enabled a transparent, reproducible workflow for pre-processing, analysis, and reporting of results.

---

# Results

## RQ1: Do EEG patterns differ between alcoholics and controls.

This research question involved testing group-level differences, particularly in shape.

To address RQ1, we plotted the mean EEG curves for both groups across each visual stimuli.


As seen in Fig 4, the S2 No-Match condition shows the greatest divergence in EEG curve shape between groups. We began by plotting the mean EEG responses for alcoholics and controls across all stimulus types, which motivated a subsequent permutation test to assess statistical significance.

\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/mean_eeg.png}
\caption{Mean EEG Curve}
\end{figure}

The permutation test for the S2 No-Match condition returned a p-value of 0.021, indicating a statistically significant difference between alcoholics and controls. As shown in Fig. 5, the observed test statistic (solid red line) lies beyond the 0.05 critical value (dashed blue line), placing it in the extreme right-hand tail of the null distribution. This indicates that the observed difference is larger than what would be expected by chance, therefore making it a globally significant result. If the observed statistic had fallen below the blue dashed threshold, we would conclude that no significant difference exists. However, here it clearly exceeds this threshold, confirming that S2 No-Match trials produce a significant shape difference between alcoholics and control


\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/perm.test.png}
\caption{Permutation Test- S2 No-Match}
\end{figure}

In contrast, the S1 and S2 Match conditions did not yield significant differences (p > 0.05), suggesting more similar neural responses between groups for simpler or repeated visual stimuli.

These findings support the hypothesis that group-level differences are most pronounced under cognitively demanding conditions, like when unexpected stimuli are presented (S2 No-Match).


## RQ2: How do different visual stimuli affect EEG signals?

This question helped us explore how the signal changes based on the stimuli type given to participants.

To address Research Question 2, we examined how the shape of EEG signals varied across the three stimulus types — S1 Object, S2 Match, and S2 No-Match — which differ in levels of cognitive demand.

\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/scores_condition.png}
\caption{FPCA Scores by Stimulus Condition}
\end{figure}
We began by plotting the average smoothed EEG curves for each condition across all participants. These curves were generated using B-spline smoothing, which we used in the earlier stages of the project.

At this point in the analysis, Fourier basis had not yet been applied, we adopted Fourier later in the pipeline, particularly during FPCA and modelling stages.
 
EEG responses to the S2 No-Match condition exhibited sharper peaks and greater amplitude, consistent with the increased cognitive effort required to process unexpected visual changes. This suggests heightened neural activation when detecting novelty.


In contrast, the S2 Match condition showed flatter and more variable curves, indicating a wider range of brain responses across participants.
This variability may reflect the brain’s reduced engagement with repeated stimuli, leading to more diffuse and inconsistent signal patterns.

These observations support the idea that stimulus type influences both the intensity and consistency of EEG responses.

To quantify these shape differences, we next examined FPCA scores by stimulus type, plotting boxplots of PC1 and PC2 to capture how key temporal features varied across S1, S2 Match, and S2 No-Match.

 

Figure 8 shows FPCA score distributions for the first two FPCA components.
 PC1 scores were higher for S1 Object and S2 No-Match, reflecting stronger average signal features in these conditions.
 In contrast, S2 Match showed a dip in PC1 and a wider spread in PC2, suggesting that repetition led to less consistent waveform shapes across subjects.

\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/fpca2.png}
\caption{FPCA Scores by Stimulus}
\end{figure}

Visual inspection of the PC1 distributions suggests a difference between stimulus types, particularly between S1 and S2 No-Match. Future work could formally test this using a Kruskal-Wallis test or similar non-parametric method.

In summary, these findings show that stimulus type has a clear effect on EEG signal shape, indicating that S2 No-Match elicited the most pronounced, high-amplitude responses, while S2 Match led to flatter, more variable signals. This shows that EEG responses reflect the cognitive demand and the novelty of the visual stimuli.
 

## RQ3: Can EEG Curves Shape Be Used To Group Participants Using Clustering?
This research question aimed to explore whether the shape of EEG signals alone could naturally group participant trials in a meaningful way, specifically in relation to subject group (alcoholic vs control) and stimulus condition.

After extracting FPCA scores for each EEG signal, we applied k-means clustering to test whether the shape-based features could uncover latent structure in the data. This allowed us to examine whether similar EEG patterns emerged across participants and whether these clusters corresponded to group status or stimulus type.

We visualised the k-means results using scatter plots of the first two FPCA components (PC1 and PC2). Each point represents a single participant trial, coloured by cluster assignment. This helps reveal how trials group based on their EEG signal shape.

\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/image.png}
\caption{Cluster Comparison by FPCA Score}
\end{figure}

Figure 9 shows the distribution of trials in the FPCA feature space, based on PC1 and PC2 scores from the FP1 electrode. Cluster 3 appears in the far-left region with predominantly negative PC1 scores, suggesting lower overall signal amplitude. Cluster 2 occupies the far-right region, associated with higher amplitude. Cluster 1 sits more centrally but spans a wide range of PC2 scores, indicating greater variation in timing or curvature.

This separation supports the idea that FPCA components effectively summarise EEG shape differences, allowing meaningful clustering based solely on temporal features.

 
\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/image (1).png}
\caption{Cluster Comparison by Group}
\end{figure}

Figure 10 further breaks down the clusters by stimulus condition and participant group.

Key observations include:

* Across all conditions, blue points (Cluster 3) tend to lie left along PC1, red points (Cluster 1) lie near the centre, and green points (Cluster 2) lie to the right.
* In S2 No-Match, this negative-positive separation along PC1 is most pronounced, creating a clearer cluster structure in comparison to S1 or S2 Match.
* Alcoholic and control trials are spread across all clusters, though their relative distribution varies with the stimulus type, suggesting an interaction between participant group and experimental condition.

These findings align with earlier results showing that the S2 No-Match condition elicits the most distinct EEG patterns. Overall, the clustering results suggest that EEG shape alone contains meaningful information that can partially recover group and stimulus-related structure without supervision.


 

## RQ 4: Can EEG Signal Shape Predict Alcoholism Status?

To test whether EEG signal shape could predict alcoholism status, we combined FPCA-derived features with two classifiers — LASSO and Random Forest (RF) — using two smoothing bases: B-spline and Fourier. Model performance was evaluated using accuracy, sensitivity, and specificity.

\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/model_comparison.png}
\caption{Model Performance Comparison}
\end{figure}

Figure 11 shows that Random Forest consistently outperformed LASSO across both basis types. The best results were achieved using Fourier smoothing with RF, yielding accuracy, sensitivity, and specificity up to 75%. In contrast, LASSO underperformed, particularly under Fourier, likely due to underfitting in high-dimensional settings.
Both sensitivity and specificity are balanced for RF, especially under Fourier smoothing, whereas LASSO struggles with all three metrics.


\begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/image (5).png}
\caption{Effect of number of FPCA components on model accuracy.}
\end{figure}

Figure 12 explores how the number of FPCA components affects model accuracy. For RF, accuracy improved as more components were added, peaking at six. In contrast, LASSO’s accuracy remained relatively flat or even declined, reinforcing its limited flexibility for this task.

These findings highlight that:

* Fourier smoothing paired with Random Forest provides the strongest predictive performance.

* FPCA components are effective input features, especially for ensemble models.

* EEG signal shape contains discriminative information relevant to alcoholism status.

* Random Forest can leverage additional shape information as the feauture set expands, while LASSO cannot

This reinforces the need for a flexible model like RF when working with FPCA scores.

### Why Fourier Performs Better:

As previously stated, Fourier smoothing better preserves wave-like oscillatory structure in EEG signals. This likely improves feature representation, enabling Random Forest to more effectively distinguish between alcoholic and control subjects. Using Fourier basis significantly improved predictive performance, especially with ensemble methods like Random Forest.
 
### Confusion Matrix Interpretation
 
Figure 3 presents the confusion matrices for the LASSO and Random Forest classifiers, showing the predicted versus actual group membership (Alcoholic vs Control). Each tile's colour intensity corresponds to the number of correctly or incorrectly classified participants, with darker shades indicating higher counts.

 \begin{figure}[H]
\centering
\includegraphics[width=0.6\textwidth]{images/confusion_matrix.png}
\caption{Confusion Matrix}
\end{figure}

The RF model demonstrates stronger performance, as seen by the darker diagonal cells, particularly in correctly identifying controls. LASSO, while also identifying controls reasonably well, shows a lighter diagonal for alcoholics, suggesting it was less effective at detecting alcoholic participants and more prone to misclassifying them as controls. These patterns indicate that RF achieved greater sensitivity and overall accuracy compared to LASSO when using EEG shape features for group classification.

*LASSO:*

* Tended to misclassify alcoholics as controls more frequently.

* Showed less separation power between groups, resulting in lower sensitivity.

*Random Forest:*

* Achieved higher counts along both diagonals (true positives and true negatives).

* More balanced sensitivity and specificity, indicating better generalisation.

*Interpretation*
Random Forest not only achieved higher accuracy but also avoided group imbalance across both subject groups.Its ensemble structure made better use of the FPCA shape features, leading to more accurate and stable predictions of group membership.


## Validating Features via Stimulus Prediction

Using the seven-harmonic Fourier FPCA scores from the frontal sensors as predictors, a Random Forest model
was trained to discriminate the three visual-stimulus conditions (S1 object, S2 match, S2 no-match). On a 25
% hold-out set the model achieved an overall accuracy of 0.75 (95 % CI 0.43 – 0.95) and a macro-averaged F1
score of 0.727. A one-sided exact binomial test against the 33 % chance level confirmed that this performance
is significantly above chance ( p = 0.0039). These results indicate that the temporal shape information
captured by the Fourier harmonics carries sufficient signal to recover which stimulus sequence a participant
was viewing, reinforcing the stimulus-specific amplitude and timing differences observed earlier in RQ 2.

##  Overall synthesis of graphical findings

The graphical outputs presented throughout this analysis demonstrate that EEG signals, when treated as functional data, yield valuable insight into cognitive processes and group differences. The mean EEG curves revealed that the S2 No-Match condition produced the strongest, most defined responses, consistent with the increased cognitive effort associated with detecting unexpected stimuli.

This observation was statistically validated via permutation testing, which identified significant differences between alcoholic and control groups, particularly under the S2 No-Match condition. The FPCA boxplots further illustrated how key components (PC1 and PC2) varied systematically with stimulus type, with PC1 capturing amplitude-related differences and PC2 reflecting variability in temporal signal structure.

Clustering analysis on FPCA scores uncovered coherent structure in the data: certain clusters were more likely to contain alcoholics or controls, and others were dominated by specific stimulus conditions. This suggests that signal shape alone, even without group labels captures meaningful variation in participant responses.

Lastly, predictive modelling using LASSO and Random Forests confirmed that these FPCA-derived scores are informative features, achieving strong classification performance. Notably, models using the Fourier basis consistently outperformed those using B-splines, likely due to their ability to better preserve oscillatory EEG structure.

Collectively, the graphical analyses highlight the power of FDA to extract interpretable, discriminative features from high-dimensional EEG data, enabling both statistical inference and predictive modelling in a cognitively meaningful way.

## Bias

Our analysis is subject to several sources of bias that warant careful consideration.
First, the relatively small sample size of (n = 16), which may limit generalisability and increase the risk of overfitting, particularly for more flexible predictive models.
Second, we focused soley on a single trial per participant per condition to standardise the data, which reduces within subject variability but in return may also discard important trial to trial fluctuations/patterns.
Third, Label imbalance across the matching conditions (stimulus types) may have influenced model performance, particularly for the multinomial classifiers.
Finally, the selection of only FP1 and FP2 sensors, while intentional to reduce noise and dimensionality, may have introduced sensor-location bias and overlook potentially informative signals from other areas of the scalp.  [@Ramsay2009; @Chiou2016]

To mitigate these biases, we adopted train/test splits, cross-validation, and tested multiple classification models. However, replication on larger and more diverse datasets would help considerably in confirming and extending these findings. [@Lotte2018]

## Ethical Considerations

The dataset used in this project was anonymised and publicly available for research purposes, with no personally identifiable information included. All analyses adhered with ethical guidelines for secondary data use.

However, working with EEG data from vulnerable populations, such as individuals with alcohol use disorder, raises important ethical considerations. Findings must be interpreted carefully to avoid pathologising people, overgeneralising results, or making deterministic conclusions based solely on brain activity. The use of machine learning in this context requires transparency, fairness, and ongoing scrutiny to ensure that predictive models do not perpetuate stigma or misrepresent group differences.

---

# Discussion
This study set out to investigate whether EEG signal shape could distinguish between alcoholic and control participants using Functional Data Analysis (FDA). By treating each EEG signal as a continuous function and applying Functional Principal Component Analysis (FPCA), we uncovered meaningful shape-based differences, especially under cognitively demanding stimuli.

In this Discussion, we interpret these findings in relation to the four research questions posed in the Introduction. This structure allows us to directly address each research aim and highlight the contributions of our functional data analysis approach.

** RQ1: Do EEG patterns differ between alcoholics and controls?**

Yes. We found statisically significant differences emerged between the groups, particularly under the S2 No-Match condition. The permutation test confirmed that the deviation in curve shape between alcoholic and control participants was unlikely to occur by chance (p = 0.021). This suggests that alcoholics exhibit altered neural processing when faced with unexpected stimuli, consistent with theories of impaired cognitive flexibility in AUD.

This result aligns with previous ERP literature, particularly studies on the P300 component. Prior work has shown that alcoholics often display reduced P300 amplitudes in oddball tasks, indicating attenuated attentional engagement and stimulus evaluation. [@Polich1994; @Porjesz2003; @Begleiter1981; @Kamarajan2006; @Rangaswamy2007] Our functional approach complements and extends this literature by retaining the full shape of the EEG waveform rather than focusing on a single latency or peak.

**RQ2: How do different visual stimuli affect EEG signals?**

Our results demonstrated that EEG responses varied systematically across stimulus types. The S2 No-Match condition, designed to introduce cognitive conflict,  elicited the strongest, most structured responses, while S2 Match (a repetition) generated flatter and more variable EEG signals. This is consistent with the expected hierarchy of cognitive demand: repetition (S2 Match) evokes less engagement, while novelty (S2 No-Match) requires heightened processing. [@Polich1994; @Handy2005; @Snodgrass1980].

The boxplots of FPCA scores by stimulus type revealed that PC1 (associated with amplitude) was highest for S2 No-Match, while PC2 (timing/variability) was most dispersed for S2 Match. These differences highlight how shape-based components of the EEG curve change under different cognitive loads.

**RQ3: Can EEG shape be used to group participants?**

Unsupervised clustering on FPCA scores produced meaningful groupings. Some clusters were enriched for alcoholics or controls, while others appeared linked to specific stimulus conditions. This suggests that EEG shape alone, without knowing participant labels, contains enough information to reveal latent structure related to cognitive traits or neurological status. These findings support the value of FPCA scores as compact, interpretable summaries of brain activity. [@Ramsay2009; @Chiou2016; @Zhang2020]

**RQ4: Can we predict alcoholism status from EEG data?**

Yes. Our classification models using FPCA scores from FP1 and FP2 achieved high accuracy, particularly when using Fourier smoothing and Random Forests (accuracy ~ 75%). This suggests that time-domain signal shape, captured through FDA, is a strong predictive feature for group classification.

The superior performance of Fourier over B-spline likely reflects its ability to capture the rhythmic, oscillatory nature of EEG.
Unlike traditional ERP measures that rely on discrete time points, this approach leverages the full-shape of the signal for improved classification which shows promise for EEG-based screening tools or cognitive profiling in clinical contexts. [@Breiman2001; @Lotte2018; @Tibshirani1996; @Hastie2009]

## Strengths

This study demonstrates several strengths that enhance the validity and interpretability of our findings:

* Preservation of full signal shape: By applying Functional Data Analysis (FDA), we retained the complete temporal structure of EEG signals, avoiding information loss associated with traditional summary measures like mean or peak amplitude. [@RamsaySilverman2002; @Ramsay2009]

* Robust statistical methods: We used non-parametric permutation testing, which does not rely on normality assumptions and is well-suited for small sample sizes and high-dimensional data. [@Maris2007; @Nichols2001]

* Exploration of signal shape: FPCA allowed us to extract interpretable components that captured meaningful differences in EEG waveform shape between groups.

* Multifaceted approach: We integrated several complementary methods (FDA, FPCA, clustering, and classification) to explore both unsupervised and supervised patterns in the data.

* Sensor Targeting: Focusing on FP1 and FP2, which are closely linked to cognitive control and attention, helped reduce complexity while maintaining theoretical relevance.

* Clear link to cognitive processing: The analysis was anchored in stimulus conditions known to evoke cognitive responses (e.g. S2 No-Match), supporting interpretation in a cognitive neuroscience context.

## Limitations

Despite numerous strengths the study presented a number of limitations.

* Sample Size: Our dataset included only 16 participants (8 per group), limiting statistical power and generalisability. While FDA methods are robust for small n, larger datasets would allow for more stable model estimation and validation.

* Trial Restriction: We focused on a single trial per stimulus per participant to ensure consistency. However, this may omit important intra-individual variability.

* Sensor Selection: Although we focused on FP1 and FP2 for theoretical and practical reasons, other electrodes (e.g. parietal or occipital regions) may capture complementary information, especially for ERP components like P300. [@Ramsay2009; @Chiou2016]

* Simplified Modelling: Our modelling used only FPCA scores from frontal sites and relatively standard classifiers. More complex architectures or incorporating additional features may yield better performance.

## Future Directions

* Multi-trial Functional Modelling: Incorporate repeated measures using functional mixed-effects models to account for within-subject variation.

* Temporal Localisation: Combine FPCA with time-frequency decomposition to detect when during the trial group differences emerge.

* Broader Populations: Apply this framework to other populations (adolescents, older adults, or clinical cohorts) to test robustness and generalisability.

* Explore full-scalp FPCA to detect spatial as well as temporal patterns. In particular, incorporating midline electrodes such as Cz (located at the vertex of the scalp) would allow us to capture activity from the primary motor and supplementary motor areas, which play a key role in reaction time, response inhibition, and attentional control, all of which are processes known to be adversely affected by alcohol use. Analysing these central sites alongside frontal electrodes (FP1, FP2) could reveal additional alcohol-related differences in cortical brain  activity patterns that are missed when only frontal sensors are considered.

* Compare time- and frequency-domain features:
Finally, future work could also examine the EEG signals in the frequency domain (for example using wavelet coefficients or by breaking the signal into alpha, beta and theta waves) alongside the time-domain FPCA features. Assessing predictive models trained on these different types of features, or combinations of both, would help determine whether frequency-based measures, which capture differences in brain rhythms that alcohol is known to affect, can improve model accuracy and give a clearer picture of the underlying brain activity and neurophysiological differences. [@Porjesz2003; @Lotte2018]

## Clinical Implications

Our findings suggest that functional patterns in EEG signals, particularly under cognitively demanding conditions, can help differentiate between alcoholic and control participants. If replicated, this approach may contribute to the development of non-invasive neurocognitive assessments for detecting early signs of cognitive impairment linked to alcohol use.

While we do not propose EEG-based classification as a diagnostic tool at this stage, the ability to capture subtle shape-based differences in brain signals has potential value for future clinical screening or research on treatment effects. Further studies using larger, longitudinal datasets could explore whether EEG curve dynamics track recovery or progression in alcohol use disorder. [@Lotte2018]


## Conclusion  

This study applied Functional Data Analysis (FDA) to EEG signals in order to explore group-level differences between alcoholic and control participants and evaluate whether signal shape could be used for classification and clustering. By treating EEG data as smooth functional curves and extracting key shape-based components using Functional Principal Component Analysis (FPCA), we were able to preserve and interpret the rich temporal dynamics of neural activity.

**Key findings:**

* Significant group differences were detected in EEG shape, particularly under the S2 No-Match stimulus condition, where alcoholic participants exhibited distinct temporal patterns compared to controls.

* Different stimulus types elicited distinct EEG responses, with S2 No-Match producing stronger and more consistent signals, likely reflecting heightened cognitive processing demands.

* Unsupervised clustering using FPCA scores revealed groupings that partially aligned with alcoholism status and stimulus condition, suggesting that signal shape carries meaningful structure even without labels.

* Predictive models using FPCA scores from FP1 and FP2 electrodes achieved strong classification performance, especially when Fourier basis functions and Random Forests were used.

These findings demonstrate the value of functional representations for analysing complex, high-dimensional time series data like EEG. FDA methods not only preserve important curve features but also produce interpretable summaries that support clustering and classification tasks. This approach offers a promising direction for identifying neural markers of cognitive dysfunction and could be extended to other domains within health data science.
Future work should expand this analysis to larger datasets, multiple trials, and additional electrodes, while exploring more advanced predictive architectures. Nevertheless, this study provides an important step toward using functional signal shape to understand and predict cognitive and neurological status. 

---

# References